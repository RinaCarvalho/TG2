{"prompt": "The following `fix_xml_ampersands` function and docstring refer to a utility function to replace all lone \"&\" characters from a given xml string by \"&amp;\", in the context of a project to download videos from video hosting services, such as Youtube. The function is as follows: ```def fix_xml_ampersands(xml_str):\n    \"\"\"Replace all lone '&' characters by '&amp;' in XML\"\"\"\n    pass```. Complete the function, having it return the replaced xml string.\n\nExample:\nInput: \"&x=y&z=a\nLet's think step by step. First, we must locate all '&' in the string. Then, we must check whether it has already been escaped, by verifying if it is already followed by an 'amp;' substring. If not, we must escape the ampersand, changing it to '&amp;'. In the example, since no ampersands were escaped yet, we must escape all of them, thus resulting in the escaped string: '\"&amp;x=y&amp;z=a'.\nOutput: \"&amp;x=y&amp;z=a", "response": "def fix_xml_ampersands(xml_str):\n    \"\"\"Replace all lone '&' characters by '&amp;' in XML\"\"\"\n\n    replaced_str = \"\"\n\n    i = 0\n    while i < len(xml_str):\n        if xml_str[i] == \"&\":\n            if i+4 < len(xml_str) and xml_str[i:i+5] != \"&amp;\":\n                replaced_str += \"&amp;\"\n                i += 1\n            else:\n                replaced_str += \"&\"\n        else:\n            replaced_str += xml_str[i]\n        i += 1\n\n    return replaced_str\n\nfix_xml_ampersands(\"&x=y&z=a\")"}